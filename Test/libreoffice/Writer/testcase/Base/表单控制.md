# 表单控制

此「常规」选项卡可用于定义表单控件的常规属性。这些属性会因控件类型的不同而有所不同，因此以下属性并不是对所有的控件均适用。

要访问此命令...

打开所选表单元素的上下文菜单-选择控件属性-常规选项卡。

打开表单设计工具栏，单击控制图标-常规选项卡。

## note

如果将当前表单文档导出为 HTML 格式，将会导出控件的默认值，而不是控件的当前值。默认值由属性的「默认值」(例如文本框) 、「默认状态」(例如复选框和选项字段) 或「默认选择」(如列表框) 决定，具体取决于控件的类型。

## URL

在URL框中输入打开文档或网页按钮类型的URL地址。单击按钮时，地址打开。

如果在「用户」模式下将鼠标置于按钮上，假如没有输入其他「帮助」文字，则 URL 将显示为扩展提示。
### 三重状态

指定复选框除TRUE和FALSE值外，是否还可以表示链接数据库的零值。此函数仅在数据库接受三种状态时可用：TRUE、FALSE和ZERO。
### 笔记

「三态」属性只可对数据库表单定义，「不可」用于 HTML 表单。

### 位置X

定义控件相对于锁定位置的 X 位置。
### 位置Y

定义控件相对于锁定位置的 Y 位置。
### 切换

指定「按钮开关」是否充当「切换按钮」。如果将「切换」设置为「是」，点击该按钮或在焦点位于该控件时按「空格」键，可以切换「已选中」或「未选中」控制状态。「已选中」状态的按钮显示为「已按下」。
列表条目

预定义默认列表条目在「默认选择」组合框中输入。

#### note

请注意，只有在「列表内容类型」下的「数据」选项卡中的「值列表」选项被选中时，此处输入的列表条目才被整合到表单内。

如果不希望将列表条目写入数据库或传送到 Web 表单的收件人，而是使用表单中不可见的指定值，可以为列表条目指定一个数值列表中的其他数值。该数值列表在 数值 选项卡上设置。在「列表内容的类型」中选择「数值列表」，然后在「列表内容」中输入数值。这些数值被指定到表单中显示的相应列表条目。为了能正确指定，请按照数值列表中相应的顺序指定。
#### note

对于 HTML 文档，在「常规」选项卡中输入的列表条目对应于 HTML 标记

## 制表位

“Tabstop”属性确定是否可以使用Tab键选择控件字段。以下选项可用：
## 否
	

当使用「Tab」键切换焦点时，跳过当前控件。

## 是
	

可以使用「Tab」键选择该控件。

前置符号

确定在使用货币字段时，货币符号是显示在数字之前还是之后。默认设置是不带前缀的货币符号。

区间

确定每次点击数值调节钮时要增大和缩小的间隔。

千位分隔符

通过数字和货币字段，您可以确定是否使用了数千个分隔符。

只读

“只读”属性可以分配给用户可以输入文本的所有控件。如果将只读属性指定给使用数据库中图形的图像字段，则用户将无法将新图形插入数据库。

可打印

指定是否希望控件字段显示在文档的打印输出中

可扩展

指定是否希望控件字段显示在文档的打印输出中

默认情况下，表格控件中按列插入的组合框始终可扩展。

可见

定义控件是否在活动模式下可见。在设计模式下，控件始终可见。

请注意，如果此属性设置为 "Yes" (默认值)，这并不意味着该控件实际会显示在屏幕上。在计算某个控件的有效可见性时，还会应用其他约束。例如，位于 Writer 隐藏区域中的控件在该区域自身变为可见之前将始终不可见。

如果此属性设置为 "No"，则在活动模式下将始终隐藏该控件。

OpenOffice.org 3.1 以前的旧版本在读取使用此属性的文档时将自动忽略此属性。

可见的大小

在「数值单位」中指定滚动条翻阅块的大小。「("最大滚动值" - "最小滚动值") /2」可得到大小为背景区域一半的翻阅块。

如果设置为「0」，翻阅块的宽度将等于其高度。

名称

每个控件字段和每个表单都有一个“Name”属性，通过该属性可以对其进行标识。该名称将出现在表单导航器中，使用该名称，可以从宏中引用控件字段。默认设置已经指定了一个使用字段标签和编号构造的名称。

note

使用宏时要确保各个控制字段的名称是唯一的。

名称也用来把具有相同功能的不同控件进行组合，例如单选按钮。为此，可以为组合的所有成员赋予相同的名称: 名称相同的控件形成一个组合。通过使用「组合框」可以直观地显示已组合的控件。

图形

图像按钮具有“Graphics”属性。“Graphics”属性指定要在按钮上显示的图形的路径和文件名。如果使用…按钮选择图形文件，则路径和文件名将自动包含在文本框中。

图标大小

指定选定导航栏中的图标是小还是大。

多重选择

允许您在列表框中选择多个项目。

大变化

指定用户在滚动条两端按钮点击时，要增加或减少的值。
字体

对于具有可见文本或标题的控件字段，请选择要使用的显示字体。要打开“字体”对话框，请单击“…”按钮。所选字体用于控制字段名称和表控制字段中的数据显示。

字符掩码

使用掩码字段，可以指定文字掩码。文字掩码包含表单的初始值，并且在下载表单后始终可见。使用编辑掩码的字符代码，可以确定用户可以在掩码字段中键入的条目。

note

字符掩码的长度要求始终与编辑掩码的长度一致。如果不一致，编辑掩码将被缩短或用空格来增加编辑掩码的长度。

定位

指定显示或隐藏选定导航栏控件中的定位项目。定位项目如下：记录标签、记录位置、记录计数标签、记录计数。

宽度

以LibreOffice模块选项中指定的单位设置表控件字段中的列宽。如果需要，可以输入一个值，后跟一个有效的测量单位，例如2 cm。

宽度

定义控件的宽度。

密码字符

如果用户输入密码，您可以确定将显示的字符，而不是用户键入的字符。在“密码字符”下，输入所需字

符的ASCII代码。您可以使用0到255之间的值。

提示



「特殊字符」对话框 (插入 - 特殊字符) 中显示了某些字符和它们对应的 ASCII公司码。

对齐/图形对齐

对齐选项包括左对齐、右对齐和居中。这些选项可用于以下元素：

标签字段的标题,

文本字段的内容,

表格控件列中表格字段的内容,

用于按钮的图形或文本。

笔记

按钮的「对齐方式」选项称为「图形对齐方式」。

导航

指定显示或隐藏选定导航栏控件中的导航项。导航项如下：第一条记录、上一条记录、下一条记录和最

后一条记录。

导航栏

指定是否在表控件的下边框上显示导航栏。

小变化

指定用户点击滚动条上的「箭头」图标时要增加或减少的值。

小数位数

通过数字和货币字段，您可以确定小数点右侧显示的位数。

差值

您可以为数字和货币数字调整按钮预设值间隔。使用旋转按钮的向上和向下箭头来增加或减少该值。

已启用

如果控件字段具有属性“Enabled”（是），则表单用户可以使用该控件字段。否则（否），它将被禁用

并灰显。

帮助 统一资源定位地址

指定URL拼写中的批次标签，该标签引用帮助文档，可以在控制字段的帮助下调用。如果焦点位于控件

字段上，并且用户按F1，则可以打开控件字段帮助的帮助。

帮助文本

提供输入将在控件上显示为提示的帮助文本的选项。当鼠标移到控件上时，提示将显示用户模式下的文

本。

对于「网址类型」按钮，帮助文本会代替输入的「网址」地址作为扩展提示显示。

帮助文本

在每个控制字段中，您可以为控制字段指定附加信息或描述性文本。此属性帮助程序员保存可在程序代

码中使用的其他信息。例如，该字段可用于变量或其他评估参数。

延迟

指定重复事件之间的延迟（毫秒）。当您单击箭头按钮或滚动条的背景或导航条的某个记录导航按钮，

并按住鼠标按钮一段时间时，会发生重复事件。您可以输入一个后跟有效时间单位的值，例如2秒或500

毫秒。

操作

您可以使用导航操作来设计自己的数据库导航按钮。


下表描述了可以指定给按钮的操作:

操作
	

说明

无
	

不执行任何操作。

提交表单
	

将当前表单其他控件字段中输入的数据发送到「表单属性」中「URL」下面指定的地址。

导出到 PDF 文件时，将 URL 输入到表单的数据属性「URL」文本框中。

重置表单
	

将其他控件字段的设置重置为预定义的默认值设置 (默认状态，「默认选择项」「默认值」)。

打开文档 / 网页
	

打开在「URL」下指定的 URL。您可以使用「框架」来指定目标框架。

第一条记录
	

将当前表单移动到第一条记录。

上一条记录
	

将当前表单移动到上一条记录。

下一条记录
	

将当前表单移动到下一条记录。

最后一条记录
	

将当前表单移动到最后一条记录。

保存记录
	

如要必要，请保存当前记录。

撤消输入数据
	

撤消对当前记录的修改。

新建记录
	

将当前表单移动到插入行。

删除记录
	

删除当前记录。

刷新表单
	

重新加载最新保存的当前表单版本。

数值

在隐藏控件的“值”下，可以输入隐藏控件继承的数据。此数据将在发送表单时传输。

数值调节钮

数字字段、货币字段、日期和时间字段可以作为表单中的数字按钮引入。

文本类型

可在控件字段中使用换行和格式化，例如文本框或标签。要手动输入换行，请按「回车」键。选择「带有格式的多行」以输入带格式的文本。

warning

如果选择「带有格式的多行」的文本类型，则无法将此控件绑定到数据库字段。

note

对于表格控件中的文本列，此控件被命名为「多行输入」。

文本行结尾为

对于文字字段，选择将文字写入数据库列时使用的行结尾代码。

断词

跨多个行显示文本。允许在文本框中使用换行符，以便可以输入多行文本。要手动输入换行符，请按「回车」键。

方向

指定滚动条或数值调节钮的水平或垂直方向。

日期格式

note

只要保留所有格式字段 (日期、时间、货币、数字)，则不管输入方式如何，它们将立即以选中格式自动套用格式。

时间格式

您可以定义所需的时间显示格式。


最大值

对于数字和货币字段，您可以确定用户可以输入的最大值。

最大文本长度

对于文本和组合框，可以定义用户可以输入的最大字符数。如果此控制字段属性不确定，则默认设置为零。

如果这个控件字段与一个数据库相关联，并且要从该数据库的字段定义中套用文本长度，则「不可以」在这里规定文本长度。只有当控件字段的属性没有被定义 (「未定义」状态)，才能从数据库中套用设置。

最大的滚动数值。

指定滚动条控件的最大值。

最小值


对于数字和货币字段，您可以确定最小值，以防止用户输入较小的值。

最小滚动值。


指定滚动条控件的最小值。

最短日期


确定用户可以输入的最早日期。

最短时间


确定用户可以输入的最短时间。

最长日期


确定用户引入的其他值不能超过的日期。

最长时间


确定用户引入的其他值不能超过的时间。

标签


“Label”属性设置表单中显示的控件字段的标签。此属性确定表控件表单中数据字段的可见标签或列标题。

如果要创建一个新的控件字段，将默认使用在「名称」属性里预定义的说明来标注控件。该标签由控件字段名称和给控件编号的整数组成 (例如「CommandButton1」)。通过「标题」属性可以给控件指定其他说明，从而使标签能够反映控件的功能。修改这个条目，使控件的标签更简练清晰，让用户一目了然。

要创建多行标题，请用「箭头」按钮打开组合框。可以按「Shift+Ctrl+回车」输入换行符。

note

「标题」属性仅用于为界面中用户可以看见的表单元素加上标签。请注意，如果用宏进行操作，运行时始终通过「名称」属性来定位控件。

标签字段


要将标签的一个字符定义为快捷键，以便用户通过在键盘上按这个字符来访问对应的控件，请在标签中的该字符之前插入波浪号 (~) 字符。

使用单选按钮时，只允许组合框架中的文本用作标签字段。此文本应用至同一组合中的所有单选按钮。

按文字字段旁的「...」按钮，您会看到一个对话框「选择标签字段」。从列表中选择一个标签。

选中「不指定」框，删除控件和指定标签字段之间的链接。

样式

指定复选框和选项按钮是以三维外观（默认）还是平面外观显示。

格式化

指定控件的格式代码。单击…按钮选择格式代码。

框架

您还可以指定目标框架，以显示单击已分配给“打开文档或网页”操作的按钮时打开的URL。

如果点击该字段，可以从列表中选择某个选项，以指定下一个文档装入的框架。有以下几种可能:

条目
	

含义

_blank
	

在一个新的空框架中创建下一个文档。

_parent
	

下一个文档将在父框中创建。如果没有父框，则文档将在本身框中创建。

_self
	

下一个文档在同一个框架内创建。

_top
	

下一个文档在最高级别窗口中创建，即该层次结构的最高框架。如果当前框架已处于最高级别窗口，那么在当前框架中创建文档。

note

「框架」属性与 HTML 表单有关，而与数据库表单「无关」。

检查格式

可以对接受格式化内容（日期、时间等）的控件字段进行格式检查。如果激活了严格格式功能（是），则只接受允许的字符。例如，在日期字段中，只接受数字或日期分隔符；用键盘键入的所有字母条目都将被忽略。

比例


调整图像大小以适合控件的大小。

滚动条


将指定的滚动条类型添加到文本框中。

点击获取焦点


如果将此选项设为「是」，在您点击该按钮时「按钮开关」将获得焦点。

符号颜色


指定控件上的符号 (例如，滚动条上的箭头) 的颜色。

筛选/排序


指定显示或隐藏选定导航栏控件中的筛选和排序项目。筛选和排序项目如下：升序排序、降序排序、排序、自动筛选、默认筛选、应用筛选、重置筛选/排序。

背景颜色


背景色可用于大多数控制字段。如果单击背景色，将打开一个列表，允许您在各种颜色中进行选择。“标准”选项采用系统设置。如果未列出所需的颜色，请单击“…”按钮在“颜色”对话框中定义颜色。

自动填充


开始键入条目后，“自动填充”功能将显示以前条目的列表。

行数


对于具有“Dropdown”属性的组合框，可以指定下拉列表中应显示的行数。对于没有下拉选项的控件字段，行的显示将由控件字段的大小和字体大小指定。

行高


在表格控件中，输入行高度值。如果需要，可以输入一个值，后跟有效的测量单位，例如2 cm。

记录操作


指定显示或隐藏所选「导航」栏控件中的操作项。操作项如下:「保存记录、撤消、新建记录、删除记录、刷新」。

记录标记


指定是否用行标签显示第一列，其中当前记录用箭头标记。

货币符号


在货币字段中，可以通过在“货币符号”属性中输入字符或字符串来预定义货币符号。

轮换顺序


“Tab order”属性确定当您按Tab键时控件在表单中的聚焦顺序。在包含多个控件的窗体中，按Tab键时，焦点将移动到下一个控件。您可以在“Tab order”下指定焦点随索引变化的顺序。

笔记

「轮换顺序」属性「不适用于」「隐藏控件」。如果需要，也可以为图像按钮和图像控件设置此属性，以便可以通过「Tab」键选择这些控件。

当创建一个表单时，插入到表单中的控件字段会被自动分配索引，每增加一个控件字段，索引会自动加「1」并分配给新增加的控件字段。如果修改一个控件字段的索引，其他控件字段的索引会自动更新。不能获得焦点的元素 (「Tabstop = No」) 也会被分配一个索引。但是在按「Tab」键时这些控件字段会被跳过。

您也可以在对话框轮换顺序中确定不同控件的索引。
输入掩码

编辑掩码的长度决定了可能的输入位置的数量。如果用户输入的字符与编辑掩码不符，则当退出该字段时将拒绝输入的内容。可以输入以下字符来定义编辑掩码:

字符
	

含义

L
	

文本常量。这个位置不能编辑。字符将在「字符掩码」的相应位置显示。

a
	

可以输入字符「a-z」与「A-Z」。大写字符不会被转换成小写字符。

A
	

可以输入字符「A-Z」。如果输入了小写字母，将被自动转换成大写字母。

c
	

可以输入字符「a-z」「A-Z」与「0-9」。大写字符不会被转换成小写字符。

C
	

可以输入字符「A-Z」与「0-9」。如果输入了小写字母，将被自动转换成大写字母。

N
	

仅可输入字符「0-9」。

x
	

输入所有可打印字符。

X
	

可以输入所有可打印的字符。如果输入了小写字母，将被自动转换成大写字母。

例如，为字符掩码 "__.__.2000" 定义编辑掩码 "NNLNNLLLLL"，以便让用户在输入日期时只输入 4 位数字。
边框

对于具有框架的控件字段，可以使用“border”属性确定表单上的边框显示。您可以选择“无框架”、“三维外观”或“平面”选项。

边框颜色


指定“border”属性设置为“flat”的控件的边框颜色。

重复


指定单击控件并按住鼠标按钮时，控件（如旋转按钮）的操作是否重复。

锁定


定义控件的锁定位置。

隐藏选取


指定当焦点不再位于控件上时，控件上的文本选择是否保持选中状态。如果将“隐藏选择”设置为“否”，则当焦点不再位于包含文本的控件上时，所选文本将保持选中状态。

高度


定义控件的高度。

默认值


设置控制字段的默认值。例如，打开表单时将输入默认值。


对于「重置」类型的按钮，「默认值」条目定义了用户激活重置按钮时控件的状态。

默认按钮


“Default button”属性指定当您按下Return键时将操作相应的按钮。如果您打开对话框或窗体，但未执行任何进一步操作，则具有此属性的按钮是默认按钮。

笔记


应只为文档中的单个按钮指定此属性。


当在 网状物页表单中查找掩码时，可能会用到此属性。输入掩码含有一个文本字段和一个「「提交」类型」的按钮。在文本字段中输入检索条目后，激活该按钮可以开始搜索。如果将该按钮定义为默认按钮，则在输入完检索条目后只需要按「回车」键就可以开始搜索。

默认文本


设置文本框或组合框的默认文本。

默认日期


设置默认日期。

默认时间


设置默认时间。

默认滚动值


设置滚动条的默认值。

默认状态


指定默认情况下是选中选项还是复选框。


对于重置类型的按钮，则可以定义用户激活重置按钮时控件的状态。


对于组合选项字段，与默认设置对应的组的状态由「默认状态」属性定义。

默认选择


指定要标记为默认条目的列表框条目。

对于「重置」类型的按钮，「默认选择」条目定义了用户激活重置按钮时列表框的状态。

对于包含值列表的「列表框」，可以点击「...」按钮打开「默认选择」对话框。

在「默认选择」对话框中，选择您希望在打开包含该列表框的表单时标记为选中的条目。

鼠标滚轮滚动

设置该值是否在用户滚动鼠标滚轮时发生更改。「从不」: 该值不发生任何更改。「在获取焦点时」: (默认) 当控件具有焦点，同时滚轮指向控件并滚动时，该值发生更改。「始终」: 无论控件是否具有焦点，当滚轮指向控件并滚动时，该值都发生更改。