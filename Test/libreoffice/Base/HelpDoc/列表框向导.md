# 组合框/列表框向导

如果在文档中插入了组合框或列表框，向导将自动启动。可以在该向导中交互指定要显示的信息。

要访问此命令...

要生成字段，请打开「表单控件」工具栏，点击「组合框」或「列表框」图标并拖动鼠标。表单中必须存在数据库连接。

## 批注

您可以使用「向导打开/关闭」图标来防止向导自动启动。

组合框向导和列表框向导在最后一步上有所差别，来源于控件字段性质:

## 「列表框」

在列表框中，用户可从列表内不同条目里选择一个条目。这些条目保存在数据库表格中，并且不通过列表框编辑。

一般说来，含有表单中可见列表条目的数据库表格不是作为表单基础的表格。表单中的列表框通过使用引用起作用；也就是说，对可见列表项目的引用位于表单表格 (值表格)，如果用户从列表中选择条目并加以保存，这些引用将同样地输入值表格中。通过引用值，列表框可以显示与当前表单表格链接的表格中的数据。由此，「列表框向导」允许链接同一数据库中的两个表格，这样，控件字段就能显示异于表单引用目标表格的表格中的数据库字段详细列表。

在其他表格中，使用字段名称 (ControlSource) 查找所需的字段，然后完成相应的字段。如果没有查找到字段名称，则列表仍为空。当列表字段中的列含有链接时，将不会先显示询问，而直接使用其他表格的第一列。

例如，如果文章表格含有供应商编号，则列表框可使用「供应商编号」链接来显示供应商表格中的供应商名称。在向导的「字段链接」页面上，会要求指定此链接的所有必需设置。

## 「组合框」

在组合框中，用户可以从列表条目中选择一个条目，也可以自己输入文字。列表中的条目可以来自任何一个数据库表格。选择或输入条目后，可以将它们只保存在表单中，此外也可以保存在数据库中。如果保存在数据库中，则这些条目将被写入到表单使用的数据库表格中。

组合框可以显示任意表格的数据，对此在当前表单表格和其数值需要在组合框里显示 (列表) 的表格间必须没有直接的连接。组合框不带引用内容工作。如果用户输入或选择数值并将其保存，则实际显示数值会列入表单表格中。因为在表单表格和列表之间没有链接，则在此不出现「连结字段」页。

如果是列表框，您从列表中选择了条目后会保存在列表表格中。如果是组合框，您可以添加附加文本，这些文本可写入并按需存储在表单当前的数据库表 (值表格) 中。对于此功能，「组合框向导将数据处理」页作为最后一页。而对于列表框，则没有这一页。在此处，您可以选择输入文本是否保存在值表格中以及保存在什么位置。

## 数据

选择与表单字段相对应的数据源和表格。如果文档已经连接到数据源，则在其中插入表单字段时不会显示此页面。

要访问此命令...

打开「表单控件」工具栏，点击「更多控件」图标，点击「表格控件」图标并拖动鼠标生成字段。不允许在当前表单中连接数据库。

数据源

指定含有所需表格的数据源。
表格

指定所需表格。

## 选择表格

从可用的数据库表格中指定一个表格，表格中数据字段的内容将显示为列表的条目。

要访问此命令...

打开「表单控件」工具栏，点击「组合框」或「列表框」图标并拖动鼠标，以生成字段。在表单中必须存在数据库连接: 向导 - 第 1 页。

对于列表框，此处将显示可与当前表单表格相链接的表格。链接表格必须至少有一个字段与当前表单表格的字段相同。只有这样，才能建立明确的引用。

对于组合框，表单表与含有显示在组合框内的数据的表之间必须有关系。
### 表格

在「表格」字段中，选择包含相应数据字段 (要在控件字段中显示其内容) 的表格。

此处给定的表格作为「列表内容」字段的 SQL 语句元素出现在「控件属性」中。

## 选择字段

从前一页表格中选择指定的数据字段，字段的内容将显示在列表框或组合框中。

要访问此命令...

打开「表单控件」工具栏，点击「组合框」或「列表框」图标并拖动鼠标，以生成字段。在表单中必须存在数据库连接: 向导 - 第 2 页。

### 现有字段

显示在向导上一页中选择的所有表格字段。
### 显示字段

指定要在组合框或列表框中显示其数据的字段。

此处给定的字段作为「列表内容」字段中 SQL 语句元素出现在「控件属性」里。

## 字段链接

指示用于链接数值表格和列表表格的字段。

值表格是插入列表字段的当前表单的表格。列表表格是要在列表字段中显示其数据的表格。这两个表格必须通过共同的数据字段进行链接。将在向导的此页面中输入这些链接。字段名称可以不同 (这取决于在两个表格中定义字段名称的方式)，但两个字段的字段类型必须相同。

要访问此命令...

打开「表单控件」工具栏，点击「列表框」图标并拖动鼠标，以生成字段。在表单中必须存在数据库连接: 向导 - 第 3 页。

### 数值表格字段

指定应该与链接表格中的字段相关联的当前表单数据字段。另外，请在以下列表字段中点击所需的数据字段。

在控件 - 属性中，指定字段以「数据」选项卡页面上「数据字段」中的条目出现。
### 列表表格字段

指定链接表格数据字段，此字段与指定的值表格字段相关联。另外，请点击下方列表字段中的数据字段。

在 控件 - 属性中，指定字段在「列表内容」下 SQL 语句的「数据」选项卡页中出现。

## 数据库字段

在组合框中，您可以在一个数据库字段中保存一个字段的数值，也可以在表单中显示该数值。

在组合字段中输入的或从列表中选择的用户数值，可以保存到通过表单访问的数据库表格中。请注意，这些数值不能保存到其他表格中。如果不将数值存入数据库中，则只能存入表单中。这对 HTML 表单尤其有用，因为在 HTML 表单中，用户输入或选中的数值将被指定到服务器。

要访问此命令...

打开「表单控件」工具栏，点击「组合框」图标并拖动鼠标，以生成字段。在表单中必须存在数据库连接: 向导 - 第 3 页。

您是否希望把数值保存在一个数据库字段？

对于此问题，有两个选项可供选择:

是，我想在以下数据库字段中保存

指定是否应该将用户输入或选择的组合字段值保存在数据库字段中。已经提供了一些可以在当前表单中访问的数据库表格字段。

在 控件 - 属性 对话框「数据」选项卡页面中，选中的字段显示为「数据字段」的一个条目。

### 列表字段

指定用于保存组合字段值的数据字段。
否，我只想将这个数值存入表单

指定不将此组合字段的值写入数据库，而只保存在表单中。

## 取消

点击「取消」关闭对话框，不保存所做的任何修改。
## 上一步

查看上一步对话框中所做的选择。当前设置保持不变。从第二个页面开始才可以激活此按钮。
## 继续

点击「下一步」按钮，「向导」将采用当前对话框的设置并转到下一步。如果到达了最后一步，对应位置的按钮变为「创建」。
