# 报告生成器


报表生成器是一种创建您自己的数据库报表的工具。与报表向导不同，使用报表生成器可以控制报表的设计方式。生成的报告是一个Writer文档，您也可以编辑它。

## 笔记


要使用报表生成器，必须安装Java Runtime Environment（JRE）软件，并且必须在LibreOffice中选择此软件。


## 安装JRE软件


报表生成器需要安装Java Runtime Environment（JRE）。


选择工具-选项-LibreOffice-高级。


请等待一分钟，LibreOffice将收集系统上已安装Java软件的信息。


如果在您的系统上找到最新的JRE版本，您会在列表中看到一个条目。


单击条目前面的选项按钮，启用此JRE版本以在LibreOffice中使用。


确保已启用“使用Java运行时环境”。


如果在您的系统上找不到JRE版本，请打开web浏览器并从下载JRE软件http://www.java.com.安装JRE软件。然后重新启动LibreOffice并再次打开Tools-Options-LibreOffice-Advanced。

## 打开报表生成器


打开基本文件或创建新数据库。数据库必须至少包含一个具有至少一个数据字段和主键字段的表。


单击“基本”窗口中的“报告”图标，然后选择“在设计视图中创建报告”。


此时将打开“报表生成器”窗口。


报表生成器分为三个部分。在顶部可以看到菜单，下面是工具栏。


在右侧，您可以看到“属性”窗口，其中包含当前选定对象的属性值。


报表生成器窗口的左侧显示报表生成器视图。报表生成器视图最初从上到下分为三个部分：


页眉-将带有固定文本的控制字段拖动到页眉区域


详细信息-将数据库字段拖放到详细信息区域


页脚-将带有固定文本的控制字段拖动到页脚区域


要插入其他报告页眉和报告页脚区域，请选择编辑-插入报告页眉/页脚。这些区域包含出现在整个报告开头和结尾的文本。


单击区域名称前面的“-”图标，可在报表生成器视图中将该区域折叠为一行。“-”图标变为“+”图标，您可以单击该图标再次展开该区域。


通过拖放到“详细信息”区域，可以插入数据库字段。请参阅下面的“向报告中插入字段”部分。


此外，您可以单击工具栏中的标签字段或文本框图标，然后在页眉或页脚区域中拖动矩形，以定义所有页面上相同的文本。您可以在相应“特性”窗口的“标签”框中输入文本。还可以使用“图形”图标添加图形。

## 将报表连接到数据库表


将鼠标移到“属性”视图。您将看到两个选项卡页面“常规”和“数据”。


在数据选项卡页面上，单击内容打开组合框。


选择要为其创建报告的表。


选择表格后，按Tab键离开内容框。


将字段添加到报告窗口将自动打开，并显示所选表的所有字段。

## 向报告添加字段


“添加字段”窗口帮助您在报告中插入表条目。


在“详细信息”视图中插入字段后，即可执行报告。

## 执行报告


单击工具栏上的执行报告图标。

一个Writer文档打开并显示您创建的报告，其中包含您插入的数据库表的所有值。


如果数据库内容发生更改，请再次执行报告以更新结果报告。

## 编辑报告


首先决定是要编辑生成的报表（静态Writer文档），还是要编辑报表生成器视图，然后根据新设计生成新报表。


Writer文档以只读方式打开。要编辑Writer文档，请单击信息栏上的“编辑文档”，或选择“编辑-编辑模式”。


如果要编辑报表生成器视图，可以更改其某些属性。


在“详细信息”区域中单击。然后在“属性”窗口中，更改一些属性，例如背景色。


完成后，单击执行报告图标以创建新报告。


如果关闭报表生成器，系统将询问您是否应保存报表。单击是，为报告命名，然后单击确定。

## 对报告进行排序


如果不进行排序或分组，记录将按从数据库检索的顺序插入报告。


打开报表生成器视图，然后单击工具栏上的排序和分组图标。您将看到“排序和分组”对话框。


在“组”框中，单击要作为第一个排序字段的字段，然后设置“排序”属性。


执行报告。


## 分组


打开报表生成器视图，然后单击工具栏上的排序和分组图标。您将看到“排序和分组”对话框。


在“组”框中，打开“组标题”列表框，然后选择以显示组标题。


单击添加字段图标以打开添加字段窗口。


将要分组的字段条目拖放到组标题部分。然后将其余字段拖放到“详细信息”部分。


执行报告。报告显示分组记录。


如果要排序和分组，请打开报表生成器视图，然后打开“排序和分组”对话框。选择以显示要分组的字段的组标题，选择以隐藏要排序的字段的“组标题”。关闭“排序和分组”窗口并执行报告。

## 更新和打印数据


当您在表中插入一些新数据或编辑数据时，新报告将显示更新的数据。


单击报告图标，然后双击上次保存的报告。将创建一个显示新数据的新Writer文档。

要打印报告，请从Writer文档中选择File-print。